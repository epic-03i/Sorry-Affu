
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Heartfelt Apology - For My Love</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;500;600&family=Great+Vibes&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK v9 -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --love-red: #ff4d6d;
            --love-pink: #ff8fa3;
            --love-light: #ffccd5;
            --love-dark: #c9184a;
            --love-purple: #b388eb;
            --shadow: 0 10px 30px rgba(255, 77, 109, 0.2);
            --transition: all 0.4s ease;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #fff5f5 0%, #ffeef0 100%);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Big Heart Animation */
        .big-heart {
            position: fixed;
            font-size: 15rem;
            z-index: 9998;
            pointer-events: none;
            opacity: 0;
            animation: bigHeartFloat 3s ease-out forwards;
            color: var(--love-red);
            text-shadow: 0 0 30px rgba(255, 77, 109, 0.7);
        }

        .broken-big-heart {
            position: fixed;
            font-size: 10rem;
            z-index: 9998;
            pointer-events: none;
            opacity: 0.3;
            animation: brokenHeartFloat 4s ease-out forwards;
            color: #888;
            filter: blur(1px);
        }

        @keyframes bigHeartFloat {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }
            20% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 0.9;
            }
            40% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            80% {
                transform: translate(-50%, -150%) scale(0.8);
                opacity: 0.7;
            }
            100% {
                transform: translate(-50%, -200%) scale(0.5);
                opacity: 0;
            }
        }

        @keyframes brokenHeartFloat {
            0% {
                transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
                opacity: 0;
            }
            20% {
                transform: translate(-50%, -50%) scale(1) rotate(-10deg);
                opacity: 0.3;
            }
            50% {
                transform: translate(-50%, -100%) scale(0.8) rotate(10deg);
                opacity: 0.25;
            }
            80% {
                transform: translate(-50%, -150%) scale(0.6) rotate(-5deg);
                opacity: 0.2;
            }
            100% {
                transform: translate(-50%, -200%) scale(0.4) rotate(0deg);
                opacity: 0;
            }
        }

        /* Header Styles */
        header {
            text-align: center;
            padding: 40px 0 30px;
            position: relative;
        }

        .header-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border: 2px solid var(--love-red);
        }

        .hearts-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }

        .floating-heart {
            position: absolute;
            color: var(--love-pink);
            font-size: 24px;
            opacity: 0.7;
            animation: floatHeart 8s infinite linear;
        }

        h1 {
            font-family: 'Great Vibes', cursive;
            font-size: 5rem;
            color: var(--love-red);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            font-size: 1.8rem;
            color: var(--love-purple);
            margin-bottom: 20px;
            font-weight: 300;
        }

        .love-icon {
            font-size: 3rem;
            color: var(--love-red);
            margin: 10px;
            display: inline-block;
            animation: heartbeat 1.5s infinite;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .apology-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 2px solid var(--love-pink);
        }

        .apology-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(255, 77, 109, 0.25);
        }

        .apology-card h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.2rem;
            color: var(--love-dark);
            margin-bottom: 25px;
            text-align: center;
        }

        .apology-text {
            font-size: 1.2rem;
            margin-bottom: 25px;
            text-align: justify;
            line-height: 1.8;
        }

        .apology-text p {
            margin-bottom: 20px;
            position: relative;
            padding-left: 20px;
            border-left: 3px solid transparent;
            transition: var(--transition);
        }

        .apology-text p:hover {
            border-left: 3px solid var(--love-red);
            padding-left: 30px;
        }

        .highlight {
            color: var(--love-dark);
            font-weight: 600;
        }

        /* Photo Gallery */
        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .photo-frame {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 200px;
            position: relative;
        }

        .photo-frame:hover {
            transform: scale(1.05);
        }

        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, var(--love-light), var(--love-pink));
            color: white;
            font-size: 3rem;
        }

        /* Interactive Elements */
        .interactive-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 30px;
        }

        .forgiveness-meter {
            width: 100%;
            background: #ffe6ea;
            height: 50px;
            border-radius: 25px;
            margin: 30px 0;
            overflow: hidden;
            border: 2px solid var(--love-pink);
        }

        .forgiveness-fill {
            height: 100%;
            width: 0%; /* Changed from 30% to 0% */
            background: linear-gradient(90deg, var(--love-pink), var(--love-red));
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: width 1s ease;
        }

        .forgiveness-controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .forgive-btn {
            background: linear-gradient(45deg, var(--love-red), var(--love-dark));
            color: white;
            box-shadow: 0 5px 15px rgba(255, 77, 109, 0.4);
        }

        .forgive-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 77, 109, 0.6);
        }

        .notyet-btn {
            background: #f0f0f0;
            color: #666;
        }

        .notyet-btn:hover {
            background: #e0e0e0;
        }

        .message-box {
            width: 100%;
            margin-top: 30px;
        }

        textarea {
            width: 100%;
            height: 150px;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid var(--love-pink);
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            resize: none;
            background: #fff9fa;
            transition: var(--transition);
        }

        textarea:focus {
            outline: none;
            border-color: var(--love-red);
            box-shadow: 0 0 0 3px rgba(255, 77, 109, 0.2);
        }

        .send-btn {
            background: linear-gradient(45deg, var(--love-purple), #8a4fff);
            color: white;
            margin-top: 15px;
            padding: 15px 40px;
            border-radius: 50px;
            border: none;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .send-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(179, 136, 235, 0.4);
        }

        /* Memories Section */
        .memories-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
            border: 2px solid var(--love-purple);
        }

        .memories-section h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            color: var(--love-purple);
            text-align: center;
            margin-bottom: 30px;
        }

        .memory-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        @media (max-width: 768px) {
            .memory-cards {
                grid-template-columns: 1fr;
            }
        }

        .memory-card {
            background: #fff9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
            border-top: 5px solid var(--love-pink);
        }

        .memory-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px rgba(255, 77, 109, 0.15);
        }

        .memory-card h3 {
            color: var(--love-dark);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .memory-card p {
            color: #666;
        }

        /* Promise Section */
        .promises-section {
            background: linear-gradient(135deg, var(--love-red), var(--love-dark));
            border-radius: 20px;
            padding: 50px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
            color: white;
            text-align: center;
        }

        .promises-section h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            margin-bottom: 30px;
            color: white;
        }

        .promises-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .promises-list {
                grid-template-columns: 1fr;
            }
        }

        .promise-item {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            text-align: left;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: var(--transition);
        }

        .promise-item:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-5px);
        }

        .promise-icon {
            font-size: 2rem;
            color: white;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 40px 0;
            color: #666;
            font-size: 1.1rem;
        }

        .final-message {
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            color: var(--love-red);
            margin-bottom: 20px;
        }

        .signature {
            font-family: 'Great Vibes', cursive;
            font-size: 3rem;
            color: var(--love-purple);
            margin-top: 20px;
        }

        /* Animations */
        @keyframes heartbeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes floatHeart {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 1s ease forwards;
        }

        /* Confetti Effect */
        .confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            background-color: var(--love-red);
            top: 0;
            opacity: 0;
            pointer-events: none;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 50px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            position: relative;
            animation: fadeIn 0.5s ease;
            border: 5px solid var(--love-red);
        }

        .modal-content h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            color: var(--love-red);
            margin-bottom: 20px;
        }

        .modal-content p {
            font-size: 1.3rem;
            margin-bottom: 30px;
            color: #555;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 2rem;
            color: var(--love-red);
            cursor: pointer;
        }

        /* Romantic Effects */
        .romantic-quote {
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            color: var(--love-purple);
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            border-top: 2px dashed var(--love-pink);
            border-bottom: 2px dashed var(--love-pink);
        }

        .love-timer {
            font-size: 1.2rem;
            color: var(--love-dark);
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 77, 109, 0.1);
            border-radius: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header with Love Theme -->
        <header>
            <div class="header-content fade-in">
                <div class="hearts-container" id="heartsContainer"></div>
                <i class="fas fa-heart love-icon"></i>
                <h1>Meri Jaan Affu</h1>
                <div class="subtitle">A Heartfelt Apology From The Depths Of My Heart</div>
                <p style="font-size: 1 rem; color: #5454549b; max-width: 800px; margin: 0 auto;">Every moment spend without you was very horrible for me. Now this is try for my convienice to you. I hope you read this all.</p>
            </div>
        </header>

        <!-- Romantic Quote -->
        <div class="romantic-quote fade-in">
            "In your eyes, I found my love. In your heart, I found my home. In your soul, I found my life." 
        </div>

        <!-- Main Apology Content -->
        <div class="main-content">
            <!-- Left Column: Apology Letter -->
            <div class="apology-card fade-in">
                <h2>My Apology</h2>
                <div class="apology-text">
                    <p>To <span class="highlight">Meri Jaan</span>,</p>
                    
                    <p>IMai jo bhi likhru mere dil se likhru. Mai jantu mai apko bahut taqleef diya shyd uski maafi bhi nhi hai. Lekin <span class="highlight">AFFU</span> ap mere liye bahut <span class="highlight">Special</span> hai, aur sacchi apko taqleef me dekhke meri ruuh kanp jati jii kasam se bahut chahtu apko.</p>
                    
                    <p>Mai apko yeh bolna chahtu sacch me mai bahut bura huu. Wajah yeh nhi ki ap dhukhi hai mere wajah se kyunki mai kabhi apke liye<span class="highlight"> Perfect</span> nhi ban saka. Mai wo insaan nhi ban saka jo ap deserve krte. Meku yeh guilt to hamesha rehta mai apko kbhi dhukh ke siwa kuch nhi de saka, aur mai kuch pehle jaisa bhi nhi sakta.</p>
                    
                    <p>Sacchi ap bahut <span class="highlight">Khaas</span> hai mere liye. Ap bahut <span class="highlight">masoom</span> hai, ap bahut <span class="highlight">sensitive</span> hai, hamesha mera <span class="highlight">khayal</span> rakhe, hamesha mera <span class="highlight">sath</span> diye - lekin badle me mai apko kuch nhi diya, hamesha sirf <span class="highlight">taqleef</span> hi diya.</p>
                    
                    <p>Mai jantu apko abhi shyd kuch smjh nhii ara kyunke apko mai itna hurt kra apke dil-o-dimag me sirf mere liye nafrat hi hai. Aur mai kuch kehna nhi chahra iske bare me apki narazgi, nafrat, gussa jayez hai. At the end. You are my <span class="highlight">everything</span>, and I can't imagine my life without you.</p>
                    
                    <p>With all my love and deepest apologies,</p>
                </div>
            </div>

            <!-- Right Column: Photo Gallery & Interactive -->
            <div class="apology-card fade-in">
                <h2>Our Beautiful Memories</h2>
                <div class="photo-gallery">
                    <div class="photo-frame">
                        <div class="photo-placeholder">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="photo-frame">
                        <div class="photo-placeholder">
                            <i class="fas fa-kiss-wink-heart"></i>
                        </div>
                    </div>
                    <div class="photo-frame">
                        <div class="photo-placeholder">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                    </div>
                </div>
                
                <div class="interactive-section">
                    <h3 style="color: var(--love-dark); margin-top: 30px;">Can you forgive me?</h3>
                    
                    <div class="forgiveness-meter">
                        <div class="forgiveness-fill" id="forgivenessFill">
                            0%
                        </div>
                    </div>
                    
                    <div class="forgiveness-controls">
                        <button class="btn forgive-btn" id="increaseForgiveness">
                            <i class="fas fa-heart"></i> I Forgive You
                        </button>
                        <button class="btn notyet-btn" id="decreaseForgiveness">
                            <i class="far fa-heart"></i> Not Yet
                        </button>
                    </div>
                    
                    <div class="message-box">
                        <h3 style="color: var(--love-dark); margin-bottom: 15px;">Write a message back to me:</h3>
                        <textarea id="loveMessage" placeholder="Write your feelings here... I'm waiting to hear from you, my love."></textarea>
                        <button class="send-btn" id="sendMessage">
                            <i class="fas fa-paper-plane"></i> Send
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Memories Section -->
        <div class="memories-section fade-in">
            <h2>What I Love About You</h2>
            <div class="memory-cards">
                <div class="memory-card">
                    <h3>Your Smile</h3>
                    <p>Apki Muskurahat mere liye ek sukoon hai ap jabhi bhi haste huwe baat krte mere se bahut khushi hoti meku dil se.</p>
                </div>
                <div class="memory-card">
                    <h3>Your Kindness</h3>
                    <p>Ap mera itna khayal rakhte meri itni fikar krte jaise mere mumma pappa krte ap bahut ache hai jii.</p>
                </div>
                <div class="memory-card">
                    <h3>Your Anger</h3>
                    <p>Apka gussa ayee hayee Meri Jaan Sacchi bolru bahut acha lagta apka gussa apka dantna meku apki har se mohabbat hai meku.</p>
                </div>
            </div>
        </div>

        <!-- Love Timer -->
        <div class="love-timer fade-in">
            <i class="fas fa-clock"></i> Every second without you feels like an eternity. I've been thinking of you for <span id="loveTimer">0</span> seconds.
        </div>

        <!-- Promises Section -->
        <div class="promises-section fade-in">
            <h2>My Promises To You</h2>
            <div class="promises-list">
                <div class="promise-item">
                    <i class="fas fa-hand-holding-heart promise-icon"></i>
                    <div>
                        <h3>I Will Listen</h3>
                        <p>I promise to always listen to you, to hear not just your words but your feelings.</p>
                    </div>
                </div>
                <div class="promise-item">
                    <i class="fas fa-heart promise-icon"></i>
                    <div>
                        <h3>I Will Cherish You</h3>
                        <p>I promise to cherish you every single day and never take you for granted.</p>
                    </div>
                </div>
                <div class="promise-item">
                    <i class="fas fa-user-shield promise-icon"></i>
                    <div>
                        <h3>I Will Protect Your Heart</h3>
                        <p>I promise to protect your heart and never intentionally hurt you again.</p>
                    </div>
                </div>
                <div class="promise-item">
                    <i class="fas fa-sun promise-icon"></i>
                    <div>
                        <h3>I Will Bring You Joy</h3>
                        <p>I promise to make you smile every day and fill your life with happiness.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Final Message -->
        <footer class="fade-in">
            <div class="final-message">
                You are my Yesterday, You are my Today, You are my Tomorrow.
            </div>
            <p style="font-size: 1.3rem; margin-bottom: 20px;">I love you more than words could ever express. You are my everything.</p>
            <div class="signature">Forever AFFu</div>
        </footer>
    </div>

    <!-- Modal for Forgiveness -->
    <div class="modal" id="forgivenessModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <i class="fas fa-heart love-icon" style="font-size: 4rem; margin-bottom: 20px;"></i>
            <h2>Thank You, My Love!</h2>
            <p>You've just made me the happiest person in the world. Your forgiveness means everything to me.</p>
            <p>I promise to spend every day making sure you never regret this decision. I love you more than anything.</p>
            <button class="send-btn" id="closeModalBtn" style="margin-top: 30px;">
                <i class="fas fa-heart"></i> I Love You
            </button>
        </div>
    </div>

    <!-- Confetti Container -->
    <div id="confettiContainer"></div>

    <script>
        // ==================== FIREBASE CONFIGURATION ====================
        const firebaseConfig = {
            apiKey: "AIzaSyCs0sAgh3K-4vx_yL-0XnO8toTEzAI3pcE",
            authDomain: "sorry-affu.firebaseapp.com",
            databaseURL: "https://sorry-affu-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "sorry-affu",
            storageBucket: "sorry-affu.firebasestorage.app",
            messagingSenderId: "158182905232",
            appId: "1:158182905232:web:a94d7b8143e54c74b90f15",
            measurementId: "G-JRVFN8ESPC"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // Firebase references
        const messagesRef = database.ref('messages');
        const forgivenessRef = database.ref('forgiveness');
        const sliderHistoryRef = database.ref('sliderHistory');

        // ==================== GLOBAL VARIABLES ====================
        let forgivenessLevel = 0; // CHANGED: Default value set to 0
        let isInitialLoad = true;

        // ==================== NOTIFICATION SYSTEM ====================
        const notificationContainer = document.createElement('div');
        notificationContainer.id = 'notificationContainer';
        notificationContainer.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 350px;
        `;
        document.body.appendChild(notificationContainer);

        function showNotification(title, message, type = 'message') {
            console.log('ðŸ“¢ Showing notification:', title, message);
            
            const notificationId = 'notif-' + Date.now();
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.id = notificationId;
            notification.style.cssText = `
                background: white;
                border-radius: 15px;
                padding: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.15);
                display: flex;
                align-items: center;
                gap: 12px;
                border-left: 5px solid var(--love-red);
                transform: translateX(400px);
                transition: transform 0.5s ease;
                position: relative;
                overflow: hidden;
            `;
            
            const icon = type === 'message' ? 'fa-paper-plane' : 
                        type === 'forgiveness' ? 'fa-heart' : 'fa-bell';
            
            notification.innerHTML = `
                <i class="fas ${icon}" style="font-size: 1.5rem; color: var(--love-red);"></i>
                <div>
                    <h4 style="color: var(--love-dark); margin-bottom: 3px; font-size: 1rem;">${title}</h4>
                    <p style="color: #666; font-size: 0.9rem;">${message}</p>
                </div>
                <button onclick="closeNotification('${notificationId}')" style="position: absolute; top: 8px; right: 8px; background: none; border: none; color: #999; cursor: pointer; font-size: 1rem;">&times;</button>
            `;
            
            notificationContainer.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            setTimeout(() => {
                closeNotification(notificationId);
            }, 5000);
            
            playNotificationSound();
        }

        function closeNotification(id) {
            const notification = document.getElementById(id);
            if (notification) {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }
        }

        function playNotificationSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } catch (e) {
                console.log("Audio not supported");
            }
        }

        // ==================== HEART ANIMATION FUNCTIONS ====================
        function createBigHeart() {
            const heart = document.createElement('div');
            heart.className = 'big-heart';
            heart.innerHTML = 'â¤';
            heart.style.left = '50%';
            heart.style.top = '50%';
            document.body.appendChild(heart);
            
            setTimeout(() => {
                heart.remove();
            }, 3000);
        }

        function createBrokenHeart() {
            const heart = document.createElement('div');
            heart.className = 'broken-big-heart';
            heart.innerHTML = 'ðŸ’”';
            heart.style.left = '50%';
            heart.style.top = '50%';
            document.body.appendChild(heart);
            
            setTimeout(() => {
                heart.remove();
            }, 4000);
        }

        // ==================== SLIDER SYSTEM ====================
        const forgivenessFill = document.getElementById('forgivenessFill');
        const increaseBtn = document.getElementById('increaseForgiveness');
        const decreaseBtn = document.getElementById('decreaseForgiveness');
        const modal = document.getElementById('forgivenessModal');
        const closeModal = document.getElementById('closeModal');
        const closeModalBtn = document.getElementById('closeModalBtn');

        function updateForgivenessMeterImmediately() {
            forgivenessFill.style.width = `${forgivenessLevel}%`;
            
            if (forgivenessLevel === 0) {
                forgivenessFill.textContent = "0%";
                forgivenessFill.style.background = "linear-gradient(90deg, #ff8fa3, #ff4d6d)";
            } else if (forgivenessLevel < 20) {
                forgivenessFill.textContent = "Angry";
                forgivenessFill.style.background = "linear-gradient(90deg, #ff8fa3, #ff4d6d)";
            } else if (forgivenessLevel < 40) {
                forgivenessFill.textContent = "Upset";
                forgivenessFill.style.background = "linear-gradient(90deg, #ffb3c1, #ff8fa3)";
            } else if (forgivenessLevel < 60) {
                forgivenessFill.textContent = "Thinking";
                forgivenessFill.style.background = "linear-gradient(90deg, #ffccd5, #ffb3c1)";
            } else if (forgivenessLevel < 80) {
                forgivenessFill.textContent = "Considering";
                forgivenessFill.style.background = "linear-gradient(90deg, #b388eb, #9d5fe9)";
            } else {
                forgivenessFill.textContent = "Forgiven!";
                forgivenessFill.style.background = "linear-gradient(90deg, #9d5fe9, #7b3fe4)";
            }
        }

        function updateForgivenessMeter() {
            forgivenessFill.style.width = `${forgivenessLevel}%`;
            
            if (forgivenessLevel === 0) {
                forgivenessFill.textContent = "0%";
                forgivenessFill.style.background = "linear-gradient(90deg, #ff8fa3, #ff4d6d)";
            } else if (forgivenessLevel < 20) {
                forgivenessFill.textContent = "Angry";
                forgivenessFill.style.background = "linear-gradient(90deg, #ff8fa3, #ff4d6d)";
            } else if (forgivenessLevel < 40) {
                forgivenessFill.textContent = "Upset";
                forgivenessFill.style.background = "linear-gradient(90deg, #ffb3c1, #ff8fa3)";
            } else if (forgivenessLevel < 60) {
                forgivenessFill.textContent = "Thinking";
                forgivenessFill.style.background = "linear-gradient(90deg, #ffccd5, #ffb3c1)";
            } else if (forgivenessLevel < 80) {
                forgivenessFill.textContent = "Considering";
                forgivenessFill.style.background = "linear-gradient(90deg, #b388eb, #9d5fe9)";
            } else {
                forgivenessFill.textContent = "Forgiven!";
                forgivenessFill.style.background = "linear-gradient(90deg, #9d5fe9, #7b3fe4)";
            }
            
            // LocalStorage mein save karo
            localStorage.setItem('forgivenessLevel', forgivenessLevel);
            localStorage.setItem('lastSave', Date.now());
            
            // Firebase mein save karo
            forgivenessRef.set({
                level: forgivenessLevel,
                lastUpdated: new Date().toLocaleString(),
                text: forgivenessFill.textContent,
                timestamp: Date.now()
            });
            
            // Slider history mein save karo
            if (!isInitialLoad) {
                sliderHistoryRef.push({
                    level: forgivenessLevel,
                    text: forgivenessFill.textContent,
                    timestamp: new Date().toLocaleString(),
                    action: forgivenessLevel > 0 ? 'increase' : 'decrease',
                    date: Date.now()
                });
            }
            
            if (forgivenessLevel >= 100) {
                showForgivenessModal();
                createConfetti();
            }
        }

        increaseBtn.addEventListener('click', () => {
            forgivenessLevel += 10;
            if (forgivenessLevel > 100) forgivenessLevel = 100;
            updateForgivenessMeter();
            
            createBigHeart();
            createConfetti();
            
            // Romantic notifications based on forgiveness level
            if (forgivenessLevel >= 100) {
                showNotification(
                    'You Have My Heart ðŸ’',
                    'I forgive you completely. My heart is yours forever.',
                    'forgiveness'
                );
            } else if (forgivenessLevel >= 80) {
                showNotification(
                    'My Heart Is Softening ðŸ’“',
                    'I can feel the love returning. Keep going, my love.',
                    'forgiveness'
                );
            } else if (forgivenessLevel >= 60) {
                showNotification(
                    'Starting To Heal ðŸ’—',
                    'Your words are touching my heart. I want to forgive you.',
                    'forgiveness'
                );
            } else if (forgivenessLevel >= 40) {
                showNotification(
                    'Feeling Your Love ðŸ’•',
                    'I can see you\'re trying. My anger is fading.',
                    'forgiveness'
                );
            } else if (forgivenessLevel >= 20) {
                showNotification(
                    'Small Steps Toward Us ðŸ’ž',
                    'I appreciate your effort. My heart is listening.',
                    'forgiveness'
                );
            } else {
                showNotification(
                    'I See Your Effort ðŸ’˜',
                    'Every apology counts. Keep showing me your love.',
                    'forgiveness'
                );
            }
        });

        decreaseBtn.addEventListener('click', () => {
            forgivenessLevel -= 15;
            if (forgivenessLevel < 0) forgivenessLevel = 0;
            updateForgivenessMeter();
            
            createBrokenHeart();
            
            showNotification(
                'My Heart Still Hurts ðŸ’”',
                'I need more time and more love from you.',
                'forgiveness'
            );
        });

        function showForgivenessModal() {
            modal.style.display = 'flex';
        }

        closeModal.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        closeModalBtn.addEventListener('click', () => {
            modal.style.display = 'none';
            createConfetti();
        });

        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // ==================== MESSAGE SYSTEM ====================
        const sendMessageBtn = document.getElementById('sendMessage');
        const loveMessage = document.getElementById('loveMessage');

        sendMessageBtn.addEventListener('click', () => {
            const message = loveMessage.value.trim();
            if (message === '') {
                alert('Please write a message, my love. I really want to know what you\'re thinking.');
                return;
            }
            
            sendMessageBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            sendMessageBtn.disabled = true;
            
            const messageData = {
                text: message,
                timestamp: new Date().toLocaleString(),
                sender: 'her',
                date: Date.now()
            };
            
            messagesRef.push(messageData)
                .then(() => {
                    showNotification(
                        'Message Sent! ðŸ’Œ',
                        'Your message has been sent successfully!',
                        'message'
                    );
                    
                    sendMessageBtn.innerHTML = '<i class="fas fa-check"></i> Sent Successfully!';
                    sendMessageBtn.style.background = 'linear-gradient(45deg, #2ecc71, #27ae60)';
                    
                    setTimeout(() => {
                        sendMessageBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Send Love';
                        sendMessageBtn.disabled = false;
                        sendMessageBtn.style.background = 'linear-gradient(45deg, var(--love-purple), #8a4fff)';
                        loveMessage.value = '';
                    }, 2000);
                })
                .catch((error) => {
                    alert('Error sending message. Please try again.');
                    sendMessageBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Send Love';
                    sendMessageBtn.disabled = false;
                    console.error('Error:', error);
                });
        });

        // ==================== OTHER FUNCTIONS ====================
        function createFloatingHearts() {
            const heartsContainer = document.getElementById('heartsContainer');
            const heartCount = 25;
            
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = 'â¤';
                
                const left = Math.random() * 100;
                const delay = Math.random() * 8;
                const duration = 8 + Math.random() * 5;
                
                heart.style.left = `${left}%`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
                
                heartsContainer.appendChild(heart);
            }
        }

        let seconds = 0;
        const loveTimer = document.getElementById('loveTimer');
        
        setInterval(() => {
            seconds++;
            loveTimer.textContent = seconds;
        }, 1000);

        function createConfetti() {
            const confettiContainer = document.getElementById('confettiContainer');
            const confettiCount = 150;
            const colors = ['#ff4d6d', '#ff8fa3', '#b388eb', '#ffccd5', '#c9184a'];
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                const color = colors[Math.floor(Math.random() * colors.length)];
                const size = Math.random() * 15 + 5;
                const left = Math.random() * 100;
                const animationDuration = Math.random() * 3 + 2;
                const delay = Math.random() * 5;
                
                confetti.style.backgroundColor = color;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                confetti.style.left = `${left}%`;
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.animation = `floatHeart ${animationDuration}s ease-in ${delay}s forwards`;
                
                confettiContainer.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, (animationDuration + delay) * 1000);
            }
        }

        // ==================== ADMIN SECRET PANEL ====================
        const adminPanel = document.createElement('div');
        adminPanel.id = 'adminPanel';
        adminPanel.style.cssText = `
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            border: 2px solid var(--love-red);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            display: none;
            z-index: 9999;
            max-width: 500px;
            max-height: 600px;
            overflow-y: auto;
        `;
        
        adminPanel.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="color: var(--love-dark);">
                    <i class="fas fa-user-secret"></i> Admin Panel
                </h3>
                <button id="closeAdmin" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--love-red);">&times;</button>
            </div>
            <div style="margin-bottom: 15px;">
                <h4>Current Forgiveness: <span id="adminForgiveness">0%</span></h4>
                <div style="background: #ffe6ea; height: 20px; border-radius: 10px; margin: 10px 0;">
                    <div id="adminForgivenessBar" style="height: 100%; width: 0%; background: var(--love-red); border-radius: 10px;"></div>
                </div>
            </div>
            <div style="margin-bottom: 15px;">
                <h4>Slider History: <span id="sliderHistoryCount">0</span> changes</h4>
                <div id="sliderHistory" style="max-height: 150px; overflow-y: auto; margin: 10px 0; padding: 10px; background: #f9f9f9; border-radius: 10px;">
                    <p style="color: #888; text-align: center; font-size: 0.9rem;">No slider changes yet...</p>
                </div>
            </div>
            <div style="margin-bottom: 15px;">
                <h4>Messages Received: <span id="messageCount">0</span></h4>
            </div>
            <div id="adminMessages" style="max-height: 200px; overflow-y: auto;">
                <p style="color: #888; text-align: center;">No messages yet...</p>
            </div>
            <button id="refreshAdmin" style="margin-top: 15px; padding: 10px 20px; background: var(--love-purple); color: white; border: none; border-radius: 10px; cursor: pointer; width: 100%;">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
        `;
        
        document.body.appendChild(adminPanel);
        
        const adminButton = document.createElement('button');
        adminButton.id = 'adminButton';
        adminButton.innerHTML = '<i class="fas fa-eye"></i>';
        adminButton.style.cssText = `
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--love-red);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 10000;
            box-shadow: 0 5px 15px rgba(255, 77, 109, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        `;
        
        document.body.appendChild(adminButton);
        
        let passwordAttempts = 0;
        const CORRECT_PASSWORD = "love123";
        
        adminButton.addEventListener('click', () => {
            if (passwordAttempts >= 3) {
                alert('Too many failed attempts. Please refresh the page.');
                return;
            }
            
            const password = prompt('Enter admin password:');
            if (password === CORRECT_PASSWORD) {
                adminPanel.style.display = 'block';
                adminButton.style.display = 'none';
                loadAdminData();
            } else {
                passwordAttempts++;
                alert(`Incorrect password. Attempts remaining: ${3 - passwordAttempts}`);
            }
        });
        
        document.getElementById('closeAdmin').addEventListener('click', () => {
            adminPanel.style.display = 'none';
            adminButton.style.display = 'flex';
        });
        
        document.getElementById('refreshAdmin').addEventListener('click', loadAdminData);
        
        function loadAdminData() {
            forgivenessRef.once('value').then((snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    if (data.level) {
                        document.getElementById('adminForgiveness').textContent = data.level + '%';
                        document.getElementById('adminForgivenessBar').style.width = data.level + '%';
                    }
                }
            });
            
            sliderHistoryRef.once('value').then((snapshot) => {
                const sliderHistoryContainer = document.getElementById('sliderHistory');
                const sliderHistoryCount = document.getElementById('sliderHistoryCount');
                
                if (snapshot.exists()) {
                    const history = snapshot.val();
                    const historyArray = Object.values(history);
                    
                    sliderHistoryCount.textContent = historyArray.length;
                    sliderHistoryContainer.innerHTML = '';
                    
                    historyArray.sort((a, b) => b.date - a.date);
                    
                    historyArray.forEach((item, index) => {
                        if (index < 5) {
                            const historyItem = document.createElement('div');
                            historyItem.style.cssText = `
                                background: ${index % 2 === 0 ? '#fff' : '#f5f5f5'};
                                padding: 8px;
                                margin-bottom: 5px;
                                border-radius: 5px;
                                font-size: 0.85rem;
                                border-left: 3px solid ${item.action === 'increase' ? '#2ecc71' : '#e74c3c'};
                            `;
                            
                            historyItem.innerHTML = `
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #666;">${item.timestamp}</span>
                                    <span style="font-weight: bold; color: ${item.level >= 80 ? '#2ecc71' : item.level >= 40 ? '#f39c12' : '#e74c3c'}">${item.level}%</span>
                                </div>
                                <div style="color: #555;">${item.text}</div>
                            `;
                            
                            sliderHistoryContainer.appendChild(historyItem);
                        }
                    });
                    
                    if (historyArray.length > 5) {
                        const moreText = document.createElement('p');
                        moreText.style.cssText = 'color: #888; text-align: center; font-size: 0.8rem; margin-top: 5px;';
                        moreText.textContent = `...and ${historyArray.length - 5} more changes`;
                        sliderHistoryContainer.appendChild(moreText);
                    }
                } else {
                    sliderHistoryContainer.innerHTML = '<p style="color: #888; text-align: center; font-size: 0.9rem;">No slider changes yet...</p>';
                    sliderHistoryCount.textContent = '0';
                }
            });
            
            messagesRef.once('value').then((snapshot) => {
                const messagesContainer = document.getElementById('adminMessages');
                const messageCountElement = document.getElementById('messageCount');
                
                if (snapshot.exists()) {
                    const messages = snapshot.val();
                    const messagesArray = Object.values(messages);
                    
                    messageCountElement.textContent = messagesArray.length;
                    messagesContainer.innerHTML = '';
                    
                    messagesArray.forEach((msg) => {
                        const messageDiv = document.createElement('div');
                        messageDiv.style.cssText = `
                            background: #f9f9f9;
                            border-radius: 10px;
                            padding: 10px;
                            margin-bottom: 10px;
                            border-left: 3px solid var(--love-purple);
                        `;
                        
                        messageDiv.innerHTML = `
                            <div style="font-size: 0.8rem; color: #888; margin-bottom: 5px;">
                                <i class="far fa-clock"></i> ${msg.timestamp || 'Just now'}
                            </div>
                            <div>${msg.text}</div>
                        `;
                        
                        messagesContainer.appendChild(messageDiv);
                    });
                } else {
                    messagesContainer.innerHTML = '<p style="color: #888; text-align: center;">No messages yet...</p>';
                    messageCountElement.textContent = '0';
                }
            });
        }

        forgivenessRef.on('value', (snapshot) => {
            if (snapshot.exists()) {
                const data = snapshot.val();
                if (data && data.level !== undefined) {
                    const currentForgiveness = document.getElementById('adminForgiveness');
                    if (currentForgiveness) {
                        currentForgiveness.textContent = data.level + '%';
                        document.getElementById('adminForgivenessBar').style.width = data.level + '%';
                    }
                }
            }
        });

        // ==================== INITIALIZATION - AUTO RESET TO 0% ====================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸ“± Page loaded, initializing...');
            
            createFloatingHearts();
            
            // AUTO RESET: Always start at 0%
            forgivenessLevel = 0;
            
            // Clear localStorage
            localStorage.removeItem('forgivenessLevel');
            localStorage.removeItem('lastSave');
            
            // Update UI immediately
            updateForgivenessMeterImmediately();
            
            // Save reset value to Firebase
            forgivenessRef.set({
                level: 0,
                lastUpdated: new Date().toLocaleString(),
                text: "0%",
                timestamp: Date.now()
            });
            
            // Mark initial load as complete
            isInitialLoad = false;
            console.log('âœ… Initial load complete - Reset to 0%');
            
            // Fade in animations
            const cards = document.querySelectorAll('.fade-in');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.2}s`;
            });
            
            setTimeout(createConfetti, 1000);
            
            const loveIcon = document.querySelector('.love-icon');
            loveIcon.addEventListener('click', () => {
                loveIcon.style.animation = 'none';
                setTimeout(() => {
                    loveIcon.style.animation = 'heartbeat 1.5s infinite';
                }, 10);
                createConfetti();
            });
            
            console.log('ðŸ”‘ Admin Panel: Click the eye button at bottom-left');
            console.log('ðŸ” Password: love123');
            
            window.addEventListener('beforeunload', () => {
                localStorage.setItem('forgivenessLevel', forgivenessLevel);
                localStorage.setItem('lastSave', Date.now());
            });
        });
    </script>
</body>
</html>
